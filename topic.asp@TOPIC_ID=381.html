<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
<title>Visio - Изменение списка custom properties</title>
<meta name="copyright" content="This Forum code is Copyright (C) 2000-09 Michael Anderson, Pierre Gorissen, Huw Reddick and Richard Kinser, Non-Forum Related code is Copyright (C) 2000-02 Snitz Communications">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<style type="text/css">
<!--
a:link    {color:darkblue;text-decoration:underline}
a:visited {color:blue;text-decoration:underline}
a:hover   {color:red;text-decoration:underline}
a:active  {color:red;text-decoration:}
.spnMessageText a:link    {color:darkblue;text-decoration:underline}
.spnMessageText a:visited {color:blue;text-decoration:underline}
.spnMessageText a:hover   {color:red;text-decoration:underline}
.spnMessageText a:active  {color:red;text-decoration:underline}
.spnSearchHighlight {background-color:yellow}
input.radio {background:lightsteelblue;color:#000000}
-->
</style>
</head>

<body bgColor="white" text="midnightblue" link="darkblue" aLink="red" vLink="blue">
<a name="top"></a>
<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-10432335-6', 'auto'); ga('send', 'pageview');</script>

<script>(function() { var cx = '002792228947284598284:fmq7et_yt8s'; var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true; gcse.src = 'https://cse.google.com/cse.js?cx=' + cx; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s); })();</script>
<div style='height: 70px; margin-left:10%; width: 80%'><div class='gcse-search'></div></div>
<table align="center" border="0" cellPadding="0" cellSpacing="0" width="95%">
  <tr>
    <td>
    
    
      <table border="0" width="100%">
        <tr>
          <td width="50%" align="left" nowrap><font face="Verdana, Arial, Helvetica" size="2">
          <img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="default.asp.html">All Forums</a><br />
          <img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="default.asp@CAT_ID=2.html">Категория Visio</a><br />
          <img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="forum.asp@FORUM_ID=2.html">Форум Вопросы и ответы</a><br />
          <img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open_topic.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;Изменение списка custom properties</font></td>
          <td align="center" width="50%">
          <font face="Verdana, Arial, Helvetica" size="2">
          </font></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table align="center" border="0" cellPadding="0" cellSpacing="0" width="95%">
  <tr>
    <td>
      <table border="0" width="100%" cellspacing="0" cellpadding="0" align="center">
        <tr>
          <td bgcolor="black">
            <table border="0" width="100%" cellspacing="1" cellpadding="4">
              <tr>
                <td align="center" bgcolor="midnightblue" width="100" nowrap><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">Author</font></b></td>
                <td align="center" bgcolor="midnightblue" width="100"><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">
                <a href="topic.asp@TOPIC_ID=386.html"><img src="icon_go_left.gif" width="15" height="15" border="0" alt="Previous Topic" title="Previous Topic" align="top" hspace="6" /></a><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">&nbsp;Topic&nbsp;</font></b><a href="topic.asp@TOPIC_ID=387.html"><img src="icon_go_right.gif" width="15" height="15" border="0" alt="Next Topic" title="Next Topic" align="top" hspace="6" /></a></font></b></td>
                <td align="right" bgcolor="midnightblue" nowrap><font face="Verdana, Arial, Helvetica" size="2">&nbsp;</font></td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font color="midnightblue" face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Евгений</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>88 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" width="100%" colspan="2" valign="top">
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;01/10/2005&nbsp;:&nbsp; 18:58:25</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> У меня очередной вопрос.<br />Есть список пропертей, он должен быть динамичным, т.е.:<br />Скажем, есть пропертя some_property_1. Ее значение пусто. Но если пользователь ввел значение, хотелось бы, чтобы появилась пропертя some_property_2, и так далее.<br />Причем обязательно новая пропертя должна появиться в списке сразу под предыдущей, а не, скажем, в конце списка.<br />Как это реализовать? МСДН молчит на эту тему.<br />Возможно, надо добавлять Cells с названием "Prop.[xxx]", где [xxx] - название проперти, но как конкретно это сделать - без понятия.<br />Подскажите, пожалуйста.</span></font></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Tumanov</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>1198 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="893"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;01/10/2005&nbsp;:&nbsp; 19:39:30</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Похоже, Вы решили серьезно поработать с Visio. Тогда для начала надо скачать Visio 2002 SDK (или 2003).<br />Помимо документации там есть Code Librarian Viewer. А в нем, в том числе, вот такой пример:<br /><br />This function creates a custom property and sets its prompt, label, format, sort key and other values, then adds it to the Visio shape specified in the function parameters.<br /><br />Requires the SetCellValueToString procedure in the Cell Value As String sample.<br />=====================<br />' Copyright (c) Microsoft Corporation.  All rights reserved.<br /><br />Public Function AddCustomProperty(vsoShape As Visio.Shape, _<br />    strLocalRowName As String, _<br />    strRowNameU As String, _<br />    strLabelName As String, _<br />    Optional vsoPropType As VisCellVals, _<br />    Optional strFormat As String, _<br />    Optional strPrompt As String, _<br />    Optional blnAskOnDrop As Boolean, _<br />    Optional blnHidden As Boolean, _<br />    Optional strSortKey As String) As Boolean<br /><br />' AddCustomProperty<br />'<br />' Abstract - This function creates a custom property<br />' for the shape that is passed in as a parameter.<br />'<br />' Parameters<br />' vsoShape          Reference to the Shape object<br />'<br />' strLocalRowName   Specifies the local name for the row.<br />'                   This name will appear in the Custom<br />'                   properties dialog for users running<br />'                   in developer mode.<br />'<br />' strRowNameU       Specifies the universal name (NameU)<br />'                   for the Custom Property row to be<br />'                   created.<br />'<br />' strLabelName      Specifies the label for the Custom<br />'                   Property.<br />'<br />' vsoPropType       Specifies the type of the value of<br />'                   the Custom Property. Not all VisCellVals<br />'                   constants are valid for this parameter.<br />'                   Only constants that start with visPropType make<br />'                   sense in this context.<br />'<br />' strFormat         Specifies the format of the<br />'                   Custom Property.<br />'<br />' strPrompt         Specifies the prompt for the<br />'                   Custom Property.<br />'<br />' blnAskOnDrop      Specifies the value of the<br />'                   Ask On Drop check box of the<br />'                   Custom Property.<br />'<br />' blnHidden         Specifies the value of the<br />'                   Hidden check box of the Custom Property.<br />'<br />' strSortKey        Specifies the value of the<br />'                   Sort key of the Custom Property.<br />'<br />' Return Value      True if successful, False otherwise.<br />'<br />    <br />    Dim vsoCell     As Visio.Cell<br />    Dim intRowIndex As Integer<br />    <br />    On Error GoTo AddCustomProperty_Err<br />    <br />    ' Add a named Custom Property row. In addition to<br />    ' adding a row with the local name (strLocalRowNname),<br />    ' this call will usually set the universal name of<br />    ' the new row to strLocalRowName as well.<br />    ' However, the universal row name will not be set<br />    ' if this shape already has a custom property row<br />    ' with the universal name (NameU) equal to strLocalRowName.<br />    intRowIndex = vsoShape.AddNamedRow(visSectionProp, _<br />         strLocalRowName, VisRowIndices.visRowProp)<br />      <br />    ' The columns of the properties that this functions<br />    ' sets are fixed, and can be accessed directly using<br />    ' the CellsSRC method and column index.<br />    <br />    ' Column 1: Prompt<br />    ' Get the Cell object.<br />    Set vsoCell = vsoShape.CellsSRC(visSectionProp, _<br />        visRowProp + intRowIndex, visCustPropsPrompt)<br />    SetCellValueToString vsoCell, strPrompt<br />    <br />    ' Any cell in the row can be used to set the<br />    ' universal row name. Only set the name if<br />    ' strRowNameU differs from the local name and<br />    ' is not blank.<br />    If (strLocalRowName &lt;&gt; strRowNameU And _<br />        Len(strRowNameU) &gt; 0) Then<br />        vsoCell.RowNameU = strRowNameU<br />    End If<br />       <br />    ' Column 2: Label<br />    Set vsoCell = vsoShape.CellsSRC(visSectionProp, _<br />        visRowProp + intRowIndex, visCustPropsLabel)<br />    SetCellValueToString vsoCell, strLabelName<br /><br />    ' Column 3: Format<br />    Set vsoCell = vsoShape.CellsSRC(visSectionProp, _<br />        visRowProp + intRowIndex, visCustPropsFormat)<br />    SetCellValueToString vsoCell, strFormat<br />   <br />    ' Column 4: Sort Key<br />    Set vsoCell = vsoShape.CellsSRC(visSectionProp, _<br />        visRowProp + intRowIndex, visCustPropsSortKey)<br />    SetCellValueToString vsoCell, strSortKey<br />   <br />    ' Column 5: Type<br />    Set vsoCell = vsoShape.CellsSRC(visSectionProp, _<br />        visRowProp + intRowIndex, visCustPropsType)<br />    vsoCell.ResultIU = vsoPropType<br />   <br />    ' Column 6: Hidden<br />    Set vsoCell = vsoShape.CellsSRC(visSectionProp, _<br />        visRowProp + intRowIndex, visCustPropsInvis)<br />    vsoCell.ResultIU = blnHidden<br />   <br />    ' Column 7: Ask to drop<br />    Set vsoCell = vsoShape.CellsSRC(visSectionProp, _<br />        visRowProp + intRowIndex, visCustPropsAsk)<br />    vsoCell.ResultIU = blnAskOnDrop<br />    <br />    AddCustomProperty = True<br />    <br />    Exit Function<br />    <br />AddCustomProperty_Err:<br />    MsgBox Err.Description<br />                      <br />End Function<br /></span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=381.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">immortal</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>391 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="894"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;01/11/2005&nbsp;:&nbsp; 09:20:31</font>
                      &nbsp;<a href="http://www.immortal.vstu.edu.ru" target="_blank"><img src="icon_homepage.gif" width="15" height="15" border="0" alt="Visit immortal's Homepage" title="Visit immortal's Homepage" align="absmiddle" hspace="6" /></a>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> добавляем проперти след образом: берем визио 2003, жмем "записать макрос" и добавляем проперти в ручную, далее останавливаем макрос и анализируем<br />сортировка: добавляет проперти всегда в конец, исключение составляет лишь случай если проперти удалены (допустим 2-я, 5-я и 8-я, будут дорбавляться соотв. сначала 2, потом 5, потом 8-я), есть свойства у пропертей "SortKey" проперти имеют расположение в соотв. с нумерацией сортировки потом по порядку, если <b>SortKey </b>у пропертей №1,№2,№3,№4,№5,№6,№7,№8,№9 имеют значение <b>1,2,3,1,1,3,1,1,No Formula, </b>то видеть вы их будете в следю порядке №1,№4,№5,№7,№8,№2,№3,№6,№9,<br />в этом случае надо запускать макрос на выполнение по какомуто событию, пока не знаю<br />можно не добавлять проперти, а заранее создать несколько штук, тогда макросы не понадобяться, а достаточно написать в свойстве "invisible"  prop.row_2 формулу =if(lookup(prop.row_1,""),0,1), в этом случае она просто будет вам открываться<br />если описать подробнее проблему, то могу конкретизировать как сделать<br />например не понятно что требуется при изменении значения?<br /><br />визио 2003 форэвер<br /><br />...а вобще-то я белый и пушистый.</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=381.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Евгений</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>88 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="895"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;01/13/2005&nbsp;:&nbsp; 12:07:28</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Извиняюсь, что долго не отвечал, было много дел в другой сфере. Но я опять с вами :)<br /><br />Попробую сконкретизировать проблему. Есть мастер, у которого есть разные проперти. Некоторый вид пропертей может появляться в разном кол-ве. К примеру, есть шейп "человек", у которого может быть разное кол-во автомобилей, по дефолту ноль. Но он может оказаться Биллом Гейтсом и иметь 473 машины. Но не творить же сразу на запас 1000 пропертей car_1, car_2... Естественным решением является введение первой проперти этого типа - car_1 - и добавление следующих при потребности. А потребность возникает, когда пользователь заполнил последнюю пропертю.<br /><br />Мы тут только что посоветовались и решили идти самым простым путем, т.е., как вы указывали, создать заранее максимальное кол-во пропертей и сделать их невидимыми.<br /><br />Г-н Туманов, а вообще зачем нужно Visio SDK? Неужели в самом Вижио + VB-editor не даются все возможности, и нужно это расширять?</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=381.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Евгений</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>88 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="896"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;01/13/2005&nbsp;:&nbsp; 12:10:18</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Кстати, а как при редактировании списка пропертей менять их порядок? Не только посортировать по столбцу, а поменять произвольным образом, например перетянуть мышью наверх? Просто иногда забываю добавить нужную пропертю в нужное место, а потом уже поздно, т.к. она добавляется в конец и ничего с этим сделать нельзя...</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=381.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">immortal</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>391 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="897"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;01/13/2005&nbsp;:&nbsp; 12:51:57</font>
                      &nbsp;<a href="http://www.immortal.vstu.edu.ru" target="_blank"><img src="icon_homepage.gif" width="15" height="15" border="0" alt="Visit immortal's Homepage" title="Visit immortal's Homepage" align="absmiddle" hspace="6" /></a>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> в ручную никак, нужно переименовывать все проперти и переставлять значения, когдато я над этим думал, но решил что нет мне смысла этого делать, т.к. это нужно только при разработке, а конечный пользователь этим пользоваться не будет, поэтому обхожусь сортировкой,<br />а так надо писать макрос (программу) с примерно след. алгоритмом:<br />задаем:<br />номер по порядку проперти перемещаемой = р1<br />номер куда надо поместить = р2<br /><br />далее вставляем в конец еще одну пропертю<br />копируем туда значенияи имя проперти р1 (причем надо учесть что имя пропертей не должны совпадать, при получении значения имени р1 измените имя р1 на другое)<br />делаем цикл смещения пропертей от р1-1 до р2 на р1 до р2+1 соотв.<br />переписываем из последней проперти в р2<br />и всего-то <img src="icon_smile.gif" width="15" height="15" border="0" alt="" title="" align="middle" /> удачи<br /><br />да забыл, не забудьте удалить последнюю пропертю которую создали<br />можно конечно и не создавать её, а хранить все в переменных, или вобще вставлять сразу в середину с помощью программы.<br /><br />визио 2003 форэвер<br /><br />...а вобще-то я белый и пушистый.</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom"><hr noshade size="1" color="gainsboro"><font face="Verdana, Arial, Helvetica" size="1" color="midnightblue">Edited by - immortal on 01/13/2005  12:55:47</font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=381.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Евгений</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>88 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="898"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;01/13/2005&nbsp;:&nbsp; 13:04:47</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Спасибо, но я тоже вдруг подумал, как и вы - мне при разработке это, хоть и не всегда удобно, но не критично, а юзеру и так все равно. Пусть тогда будет, как есть :)</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=381.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Digitall</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>389 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="899"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;01/13/2005&nbsp;:&nbsp; 13:18:11</font>
                      &nbsp;<a href="http://prodigitall.narod.ru" target="_blank"><img src="icon_homepage.gif" width="15" height="15" border="0" alt="Visit Digitall's Homepage" title="Visit Digitall's Homepage" align="absmiddle" hspace="6" /></a>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> <font size="1" face="Verdana, Arial, Helvetica" id="quote"><blockquote id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by immortal</i><br /><br />в ручную никак, нужно переименовывать все проперти и переставлять значения, когдато я над этим думал, но решил что нет мне смысла этого делать, т.к. это нужно только при разработке, а конечный пользователь этим пользоваться не будет, поэтому обхожусь сортировкой,<br />а так надо писать макрос (программу) с примерно след. алгоритмом:<br />задаем:<br />номер по порядку проперти перемещаемой = р1<br />номер куда надо поместить = р2<br /><br />далее вставляем в конец еще одну пропертю<br />копируем туда значенияи имя проперти р1 (причем надо учесть что имя пропертей не должны совпадать, при получении значения имени р1 измените имя р1 на другое)<br />делаем цикл смещения пропертей от р1-1 до р2 на р1 до р2+1 соотв.<br />переписываем из последней проперти в р2<br />и всего-то <img src="icon_smile.gif" width="15" height="15" border="0" alt="" title="" align="middle" /> удачи<br /><br />да забыл, не забудьте удалить последнюю пропертю которую создали<br />можно конечно и не создавать её, а хранить все в переменных, или вобще вставлять сразу в середину с помощью программы.<br /><br />визио 2003 форэвер<br /><br />...а вобще-то я белый и пушистый.<br /><hr height="1" noshade id="quote"></blockquote></font><br />Заметил интересное поведение.<br />Допустим у фигуры есть 10 Custom Properties. Если просто зайти в ShapeSheet и вставить строку, то программа поставит новое свойство в конец списка, но если удалить, к примеру, 5-е свойство и вставить строку, то в этом случае программа поставит новую строку взамен старой, равно как и следующую строку, т.е. будет выполнена вставки строки в середину списка. Я пока не знаю, можно ли это сделать программно, но ручками возможно.</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=381.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">immortal</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>391 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="900"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;01/13/2005&nbsp;:&nbsp; 14:00:14</font>
                      &nbsp;<a href="http://www.immortal.vstu.edu.ru" target="_blank"><img src="icon_homepage.gif" width="15" height="15" border="0" alt="Visit immortal's Homepage" title="Visit immortal's Homepage" align="absmiddle" hspace="6" /></a>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> <font size="1" face="Verdana, Arial, Helvetica" id="quote"><blockquote id="quote">quote:<hr height="1" noshade id="quote">Допустим у фигуры есть 10 Custom Properties. Если просто зайти в ShapeSheet и вставить строку, то программа поставит новое свойство в конец списка, но если удалить, к примеру, 5-е свойство и вставить строку, то в этом случае программа поставит новую строку взамен старой, равно как и следующую строку, т.е. будет выполнена вставки строки в середину списка. Я пока не знаю, можно ли это сделать программно, но ручками возможно.<hr height="1" noshade id="quote"></blockquote></font><br />опоздал<br /> <font size="1" face="Verdana, Arial, Helvetica" id="quote"><blockquote id="quote">quote:<hr height="1" noshade id="quote">исключение составляет лишь случай если проперти удалены (допустим 2-я, 5-я и 8-я, будут дорбавляться соотв. сначала 2, потом 5, потом 8-я), <hr height="1" noshade id="quote"></blockquote></font><br /><br />на мой взгляд хуже нету (я имею в виду для программы) чем удаление из середины и вставка вновь, т.к замечено что у меня обращение из программы идет по номеру строки, и при удалении 5- й строки, номер строки 6 становиться 5-м, а ссылка на 6 строку останется на 6<br />...CellsSRC(visSectionUser,6,visUserValue).formulaU<br /><br />так-что думаю что трудновато отследить, а тем более задать, т.к. при задании командой не указывается номер строки, если удалены 5 и 6, то невозможно вставить сначала 6 а потом 5<br />програмно будут добавляться 5 потом 6 потом в конец<br />к стати всех с наступающим новым годом<br /><br />визио 2003 форэвер<br /><br />...а вобще-то я белый и пушистый.</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=381.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Евгений</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>88 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="901"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;01/13/2005&nbsp;:&nbsp; 15:31:02</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> &gt;к стати всех с наступающим новым годом<br /><br />Вас с тем же :)</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=381.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">TuzhibaevTA</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>85 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="920"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;01/17/2005&nbsp;:&nbsp; 09:41:05</font>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Ну и запросы у Вас, сказала база данных и зависла :).<br />Я тоже начал сурьезно изучать Visio и его окошко с "пропертями".<br />И пришел к выводу что лучше бы мне его не трогать (так как мои запросы к этому окошку возрастали с каждым днем), а воспользоваться механизмами расширения через окошки Visio.<br />Вот что я нарыл сегодня в MSDN: <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnvisio00/html/visanchorwindows.asp" target="_blank">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnvisio00/html/visanchorwindows.asp</a><br />Пример так же работает и в 2003 версии.<br /><br />Тужибаев Тимур</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=381.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td align="center" bgcolor="midnightblue" width="100" nowrap><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">&nbsp;</font></b></td>
                <td align="center" bgcolor="midnightblue" width="100"><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">
                <a href="topic.asp@TOPIC_ID=386.html"><img src="icon_go_left.gif" width="15" height="15" border="0" alt="Previous Topic" title="Previous Topic" align="top" hspace="6" /></a><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">&nbsp;Topic&nbsp;</font></b><a href="topic.asp@TOPIC_ID=387.html"><img src="icon_go_right.gif" width="15" height="15" border="0" alt="Next Topic" title="Next Topic" align="top" hspace="6" /></a></font></b></td>
                <td align="right" bgcolor="midnightblue" nowrap><font face="Verdana, Arial, Helvetica" size="2">&nbsp;</font></td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table style="margin-top: 15px" border="0" width="95%" align="center" cellpadding="8" cellspacing="0">
  <tr valign="top">
      <td align="center" bgcolor="#ffffAA"><font face="Verdana, Arial, Helvetica" size="2">Данный сайт является архивом форума visio.artberg.ru, который был закрыт в связи с переходом на новую платформу <b><a href="http://visio.getbb.ru">visio.getbb.ru</a></b><br/>Все материалы доступны только для чтения! Если у вас появились вопросы, или вы хотите что-то обсудить, связанное с Visio, обращайтесь на новый форум!<br/>Архив был создан благодаря совместным усилиям Генадия Туманова @Tumanov (<a href="http://visio.artberg.ru">visio.artberg.ru</a>), Александра ака @Surrogate (<a href="http://visio.getbb.ru">visio.getbb.ru</a>), и Николая Белых @nbelyh (<a href="http://unmanagedvisio.com">unmanagedvisio.com</a>)</font></td>
  </tr>
</table></body>
</html>
