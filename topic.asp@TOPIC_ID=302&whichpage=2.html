<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
<title>Visio - SaveAsWeb проблема хелп плз.</title>
<meta name="copyright" content="This Forum code is Copyright (C) 2000-09 Michael Anderson, Pierre Gorissen, Huw Reddick and Richard Kinser, Non-Forum Related code is Copyright (C) 2000-02 Snitz Communications">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<style type="text/css">
<!--
a:link    {color:darkblue;text-decoration:underline}
a:visited {color:blue;text-decoration:underline}
a:hover   {color:red;text-decoration:underline}
a:active  {color:red;text-decoration:}
.spnMessageText a:link    {color:darkblue;text-decoration:underline}
.spnMessageText a:visited {color:blue;text-decoration:underline}
.spnMessageText a:hover   {color:red;text-decoration:underline}
.spnMessageText a:active  {color:red;text-decoration:underline}
.spnSearchHighlight {background-color:yellow}
input.radio {background:lightsteelblue;color:#000000}
-->
</style>
</head>

<body bgColor="white" text="midnightblue" link="darkblue" aLink="red" vLink="blue">
<a name="top"></a>

<script>(function() { var cx = '002792228947284598284:fmq7et_yt8s'; var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true; gcse.src = 'https://cse.google.com/cse.js?cx=' + cx; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s); })();</script>
<div style='height: 70px; margin-left:10%; width: 80%'><div class='gcse-search'></div></div>
<table align="center" border="0" cellPadding="0" cellSpacing="0" width="95%">
  <tr>
    <td>
    
    
      <table border="0" width="100%">
        <tr>
          <td width="50%" align="left" nowrap><font face="Verdana, Arial, Helvetica" size="2">
          <img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="default.asp.html">All Forums</a><br />
          <img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="default.asp@CAT_ID=2.html">Категория Visio</a><br />
          <img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="forum.asp@FORUM_ID=2.html">Форум Вопросы и ответы</a><br />
          <img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open_topic.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;SaveAsWeb проблема хелп плз.</font></td>
          <td align="center" width="50%">
          <font face="Verdana, Arial, Helvetica" size="2">
          </font></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td align="right" valign="top"><font face="Verdana, Arial, Helvetica" size="1"><a href="topic.asp@TOPIC_ID=302&amp;whichpage=1.html" title="Goto the Previous page in this Topic" onMouseOver="(window.status='Goto the Previous page in this Topic'); return true" onMouseOut="(window.status=''); return true">Previous Page</a></font></td>
  </tr>
</table>
<table align="center" border="0" cellPadding="0" cellSpacing="0" width="95%">
  <tr>
    <td>
      <table border="0" width="100%" cellspacing="0" cellpadding="0" align="center">
        <tr>
          <td bgcolor="black">
            <table border="0" width="100%" cellspacing="1" cellpadding="4">
              <tr>
                <td align="center" bgcolor="midnightblue" width="100" nowrap><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">Author</font></b></td>
                <td align="center" bgcolor="midnightblue" width="100"><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">
                <a href="topic.asp@TOPIC_ID=309.html"><img src="icon_go_left.gif" width="15" height="15" border="0" alt="Previous Topic" title="Previous Topic" align="top" hspace="6" /></a><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">&nbsp;Topic&nbsp;</font></b><a href="topic.asp@TOPIC_ID=308.html"><img src="icon_go_right.gif" width="15" height="15" border="0" alt="Next Topic" title="Next Topic" align="top" hspace="6" /></a></font></b></td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Mihail</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>10 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="637"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;08/18/2004&nbsp;:&nbsp; 17:48:46</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> код работает спасибо.. скачал SDK для 2002 Visio там кое что есть.<br />но т.к. ни разу не сталкивался не могу ни как сделать отдельный модуль из этого кода. Как придумать, что бы можно было, для любого документа визио, потом делать так <br />application.addons("SaveasWeb").Run "/quiet=True /target=path\test.htm"<br /><br /><br /><br /></span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=302&amp;whichpage=2.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">immortal</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>391 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="638"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;08/19/2004&nbsp;:&nbsp; 06:05:33</font>
                      &nbsp;<a href="http://www.immortal.vstu.edu.ru" target="_blank"><img src="icon_homepage.gif" width="15" height="15" border="0" alt="Visit immortal's Homepage" title="Visit immortal's Homepage" align="absmiddle" hspace="6" /></a>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> <font size="1" face="Verdana, Arial, Helvetica" id="quote"><blockquote id="quote">quote:<hr height="1" noshade id="quote"> не могу ни как сделать отдельный модуль из этого кода. Как придумать, что бы можно было, для любого документа визио, потом делать так<hr height="1" noshade id="quote"></blockquote></font>значит так!<br />устанавливаешь визуал бейсик 6<br />запускаешь его, сразу выходит окно, где выбираешь создание нового проекта: Standart EXE<br />Имеем чистую форму<br />кликаем дважды на форме, открывается окно с кодом формы и сразу создаст обработку события, в данном случае загрузка формы: Form_Load<br />вставляем следующий код вне событий, в начале кода формы:<br />Public <b>vis</b> As Object 'определяем переменную визио для всего модуля, далее значение этой переменной будет во всех модулях формы<br /><br />далее в <br />Private Sub Form_Load()<br />Set <b>vis</b> = GetObject(, "Visio.Application") 'определяем ссылку на объект визио<br />'ну и любые операции с документом визио, в нашем случае<br /><br /><b>vis</b>.application.addons("SaveasWeb").Run "/quiet=True /target=path\test.htm" ' учтите, если документ не открыт произойдет ошибка<br />End Sub<br /><br />для открытия документа:<br />vis.Application.document.openex "путь к документу", visopenrw<br />только не знаю работает ли при закрытом визио, по идее должно<br /><br />для поиска файлов воспользуйся функцией dir<br />после отладки вставь обработку ошибок<br />on error resume next<br /><br />для закрытия формы:<br />unload form1<br />если это поставить в функцию Form_Load то после всех операций она выгрузится сама<br />если будет использоваться только эта функция, то Public <b>vis</b> As Object можно определить в нутри неё dim <b>vis</b> As Object<br /><br />в данном случае любой код в VBA переделывается в VB добавлением в начале <b>vis</b>, соответственно если вы назовете эту переменную по другому, то и тут она измениться, как пример работы с внешним приложением можно взять для екселя, ворда или другого компанента офиса, в экселе GetObject(, "Excel.Application") а в визио будет GetObject(, "Visio.Application"), удачи<br /><br /><br />сохраняем ехе проект и усе<br /></span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom"><hr noshade size="1" color="whitesmoke"><font face="Verdana, Arial, Helvetica" size="1" color="midnightblue">Edited by - immortal on 08/19/2004  06:08:29</font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=302&amp;whichpage=2.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Tumanov</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>1198 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="640"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;08/19/2004&nbsp;:&nbsp; 15:52:09</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Хочется внести некоторые уточнения...<br /><br />Форма, как я понимаю, здесь совершенно не нужна - сойдет и консольное приложение.<br />Visio нет смысла держать все время открытым, достаточно открывать, когда нужно.<br />Лучше открывать его вообще в невидимом режиме - чего зря экраном трясти...<br />Остальное я написал чуть раньше, чем увидел последний ответ, но корректировать не буду - пусть будет второй вариант :)<br /><br />Маленькая тонкость - объект VisSaveAsWeb может использоваться только in-process. Это значит - из макроса Visio или Add-In. Вам же, как я понял, нужно работать из внешней программы. В этом случае лучше пользоваться готовым Add-On, поставляемым и автоматически устанавливающимся с Visio и работающим в режиме командной строки.<br />Общая схема такая: Нужно запустить .exe (Вашу программу) - программа откроет документ Visio и использует в нем метод Run имеющегося в коллекции Visio аддона SaveAsWeb с передачей ему нужных параметров командной строки. Потом закроет документ Visio и сама завершится.<br /><br />Программа создается в VB6 (например, в Visual Studio).<br />Я делал консольное приложение вот с таким кодом:<br /><br />Sub Main()<br /><br />    Dim appVisio As Visio.Application<br />    Dim docsObj As Visio.Documents<br />    Dim docObj As Visio.Document<br />    Dim pagsObj As Visio.Pages<br /><br />    Set appVisio = CreateObject("Visio.InvisibleApp")<br />    Set docsObj = appVisio.Documents<br />    Set docObj = docsObj.Add("C:\temp\Drawing1.vsd")<br />    Set pagsObj = appVisio.ActiveDocument.Pages<br />    appVisio.Addons("SaveAsWeb").Run "/quiet=True /target=C:\temp\Drawing1.htm"<br />    appVisio.Quit<br />    <br />End Sub<br /><br />pagsObj здесь не нужен, но понадобится, если Нужно будет узнать количество страниц в документе.<br />Visio открывается в невидимом режиме.<br />Программа сохраняет рисунок Drawing1.vsd в виде Drawing1.htm<br />В References проекта должна присутствовать ссылка на Visio (у меня это Microsoft Visio 2002 Type Library).<br />Выполняется Make, получается .exe, его можно положить в любую папку и запускать, когда надо вручную или каким-то скриптом.<br /><br />Естественно, все это можно сделать и не в VB6, а в другой среде.<br /></span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=302&amp;whichpage=2.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Mihail</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>10 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="646"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;08/20/2004&nbsp;:&nbsp; 10:15:26</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> ... да , все очень здорово .. <br />я тут пол дня обновлял свою win2k.. обалдеть скока ей надо было..  поставил все ж таки  VS.net  версия VB 7 пишет .. не знаю хорошо это или нет . .но дугои у меня не нашлось только VS98 есть еще но ее не ставил. <br />и тут читая ваши ответы заметил что мне наверное не совсем то нужно сделать то.. <br />был код который sab saveasweb() заработал у меня. <br />так вот мне нужно сначала следать этот код ADD-ON-ом как то, а сие у меня ни как не получается пока. <br />а параметры этому адону я могу и напрямую из Lotus передавать <br />appVisio.Addons("SaveAsWeb").Run "/quiet=True /target=C:\temp\Drawing1.htm". и exe  другои какои то для чего мне не поиму пока . <br />подскажите плз как сделать мне Add-on с методом SaveAsWeb  или этот Add-on где то есть уже .. и я просто не вкуриваю чего то..<br />Сенькс. Михаил.<br /></span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom"><hr noshade size="1" color="whitesmoke"><font face="Verdana, Arial, Helvetica" size="1" color="midnightblue">Edited by - Mihail on 08/20/2004  10:17:54</font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=302&amp;whichpage=2.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Mihail</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>10 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="647"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;08/20/2004&nbsp;:&nbsp; 10:53:34</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Ребяты ! огромный пардон .. я супер тормоз, такую тему тут накрутил <br />столько сам тут навозился vs.net и т.п. .. а оказывается все так.. <br />я сеичас просто в лотусе поставил строку в коде (догадался так и )<br />appVisio.Addons("SaveAsWeb").Run ("/quiet=True /openbrowser =False /target=C:\temp\test.htm")<br />и у меня, весь документ, как вы думаете .. благополучно сохранился как веб страница .. все просто супер ..спасибо огромное, что помогли разобраться..</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom"><hr noshade size="1" color="gainsboro"><font face="Verdana, Arial, Helvetica" size="1" color="midnightblue">Edited by - Mihail on 08/20/2004  11:21:17</font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=302&amp;whichpage=2.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td align="center" bgcolor="midnightblue" width="100"><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">
                <a href="topic.asp@TOPIC_ID=309.html"><img src="icon_go_left.gif" width="15" height="15" border="0" alt="Previous Topic" title="Previous Topic" align="top" hspace="6" /></a><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">&nbsp;Topic&nbsp;</font></b><a href="topic.asp@TOPIC_ID=308.html"><img src="icon_go_right.gif" width="15" height="15" border="0" alt="Next Topic" title="Next Topic" align="top" hspace="6" /></a></font></b></td>
                <td align="right" bgcolor="midnightblue" nowrap><font face="Verdana, Arial, Helvetica" size="2">&nbsp;</font></td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td align="left" valign="top"><font face="Verdana, Arial, Helvetica" size="1"><a href="topic.asp@TOPIC_ID=302&amp;whichpage=1.html" title="Goto the Previous page in this Topic" onMouseOver="(window.status='Goto the Previous page in this Topic'); return true" onMouseOut="(window.status=''); return true">Previous Page</a></font></td>
  </tr>
</table>
<table style="margin-top: 15px" border="0" width="95%" align="center" cellpadding="8" cellspacing="0">
  <tr valign="top">
      <td align="center" bgcolor="#ffffAA"><font face="Verdana, Arial, Helvetica" size="2">Данный сайт является архивом форума visio.artberg.ru, который был закрыт в связи с переходом на новую платформу <b><a href="http://visio.getbb.ru">visio.getbb.ru</a></b><br/>Все материалы доступны только для чтения! Если у вас появились вопросы, или вы хотите что-то обсудить, связанное с Visio, обращайтесь на новый форум!<br/>Архив был создан благодаря совместным усилиям Генадия Туманова @Tumanov (<a href="http://visio.artberg.ru">visio.artberg.ru</a>), Александра ака @Surrogate (<a href="http://visio.getbb.ru">visio.getbb.ru</a>), и Николая Белых @nbelyh (<a href="http://unmanagedvisio.com">unmanagedvisio.com</a>)</font></td>
  </tr>
</table></body>
</html>
