<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
<title>Visio - Помогите создать Add on</title>
<meta name="copyright" content="This Forum code is Copyright (C) 2000-09 Michael Anderson, Pierre Gorissen, Huw Reddick and Richard Kinser, Non-Forum Related code is Copyright (C) 2000-02 Snitz Communications">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<style type="text/css">
<!--
a:link    {color:darkblue;text-decoration:underline}
a:visited {color:blue;text-decoration:underline}
a:hover   {color:red;text-decoration:underline}
a:active  {color:red;text-decoration:}
.spnMessageText a:link    {color:darkblue;text-decoration:underline}
.spnMessageText a:visited {color:blue;text-decoration:underline}
.spnMessageText a:hover   {color:red;text-decoration:underline}
.spnMessageText a:active  {color:red;text-decoration:underline}
.spnSearchHighlight {background-color:yellow}
input.radio {background:lightsteelblue;color:#000000}
-->
</style>
</head>

<body bgColor="white" text="midnightblue" link="darkblue" aLink="red" vLink="blue">
<a name="top"></a>

<script>(function() { var cx = '002792228947284598284:fmq7et_yt8s'; var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true; gcse.src = 'https://cse.google.com/cse.js?cx=' + cx; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s); })();</script>
<div style='height: 61px' class='gcse-search'></div>
<table align="center" border="0" cellPadding="0" cellSpacing="0" width="95%">
  <tr>
    <td>
    
    
      <table border="0" width="100%">
        <tr>
          <td width="50%" align="left" nowrap><font face="Verdana, Arial, Helvetica" size="2">
          <img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="default.asp.html">All Forums</a><br />
          <img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="default.asp@CAT_ID=2.html">Категория Visio</a><br />
          <img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="forum.asp@FORUM_ID=2.html">Форум Вопросы и ответы</a><br />
          <img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open_topic.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;Помогите создать Add on</font></td>
          <td align="center" width="50%">
          <font face="Verdana, Arial, Helvetica" size="2">
          </font></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table align="center" border="0" cellPadding="0" cellSpacing="0" width="95%">
  <tr>
    <td>
      <table border="0" width="100%" cellspacing="0" cellpadding="0" align="center">
        <tr>
          <td bgcolor="black">
            <table border="0" width="100%" cellspacing="1" cellpadding="4">
              <tr>
                <td align="center" bgcolor="midnightblue" width="100" nowrap><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">Author</font></b></td>
                <td align="center" bgcolor="midnightblue" width="100%"><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">
                <a href="topic.asp@TOPIC_ID=905.html"><img src="icon_go_left.gif" width="15" height="15" border="0" alt="Previous Topic" title="Previous Topic" align="top" hspace="6" /></a><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">&nbsp;Topic&nbsp;</font></b><a href="topic.asp@TOPIC_ID=922.html"><img src="icon_go_right.gif" width="15" height="15" border="0" alt="Next Topic" title="Next Topic" align="top" hspace="6" /></a></font></b></td>
                <td align="right" bgcolor="midnightblue" nowrap><font face="Verdana, Arial, Helvetica" size="2">&nbsp;</font></td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font color="midnightblue" face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">davinchi</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>6 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" width="100%" colspan="2" valign="top">
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;12/06/2006&nbsp;:&nbsp; 15:59:01</font>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Есть задача сделать интерактивный трафарет содержащиф несколько групп свойств, которые должны вводиться через собственное окно свойств...<br />Трафарет примерно следующего плана:<br /><font face="Courier New"><br />|---------------------------|<br />|     &lt;Тип трафарета&gt;       |+<br />|   &lt;Название трафарета&gt;    |<br />|---------------------------|<br />|&lt;Название раздела свойств1&gt;|<br />|---------------------------|<br />|&lt;Свойство1&gt;:&lt;Тип&gt;          |+<br />|&lt;Свойство2&gt;:&lt;Тип&gt;          |+<br />|...                        |+<br />|&lt;СвойствоN&gt;:&lt;Тип&gt;          |+<br />|---------------------------|<br />|&lt;Название раздела свойств2&gt;|<br />|---------------------------|<br />|&lt;Свойство1&gt;:&lt;Тип&gt;          |+<br />|&lt;Свойство2&gt;:&lt;Тип&gt;          |+<br />|...                        |+<br />|&lt;СвойствоN&gt;:&lt;Тип&gt;          |+<br />|---------------------------|<br />|...                        |<br />|---------------------------|<br />|&lt;Название раздела свойствN&gt;|<br />|---------------------------|<br />|&lt;Свойство1&gt;:&lt;Тип&gt;          |+<br />|&lt;Свойство2&gt;:&lt;Тип&gt;          |+<br />|...                        |+<br />|&lt;СвойствоN&gt;:&lt;Тип&gt;          |+<br />|---------------------------|<br /></font><br />плюсами отмечены точки соединения...<br />в угловых скобках "&lt;...&gt;" расположен изменяемый текст, который должен вводиться из собственного окна свойств, в котором выберается тип трафарета, вводится название трафарета, создаются разделы свойств и вводятся свойства... на первый взгляд можно реализовать окно свойств с помощью макросов и VBA, но я знаком только с Delphi и в нем создать такое окошко не проблема, а далее взаимодействовать с трафоретом через OLE... возможности Visio, такое позволяют, к примеру, трафарет класса из диаграммы UML использует окно свойств из аддона.<br /><b>Уважаемые ГУРУ Visio, просветите пожалуйса как создавать аддон и связать его с трафаретом...</b><br /></span></font></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Tumanov</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>1198 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="3068"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;12/06/2006&nbsp;:&nbsp; 19:07:49</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> 1. Сначала оговорим терминологию...<br />Трафаретом (Stencil) в Visio называется специальный документ, хранящий мастер-шейпы. Трафарет хранится в файле .vss и открывается обычно в отдельном окошке слева от окна рисунка Visio.<br />Вы скорее всего спрашиваете о том, как сделать мастер-шейп. Дальше я буду исходить из этого предположения.<br />2. Под связью с трафаретом скорее всего понимается вызов Add-On при каких-то действиях с шейпом и доступ из Add-On к шейпу.<br />Для вызова Add-On проще всего использовать события EventDblClick (двойной щелчок по шейпу, когда он уже на рисунке) и EventDrop (когда мастер-шейп переносится с трафарета на рисунок и на рисунке создается его копия). Для такой связи нужно всего лишь прописать вызов нужного Add-On в соответствующей ячейке ShapeSheet нужного шейпа (мастер-шейпа). Для двойного щелчка это можно сделать через интерфейс (меню Format / Behavior / Double-Click, Run macro), а для EventDrop сделать по аналогии.<br />Можно вызывать и по другим событиям, но это будет чуть посложнее.<br />3. При вызове Add-On Visio передает ему несколько параметров обращения. Это индексы документа, страницы, шейпа. Через эти параметры Add-On может получить доступ к объектной модели Visio, в том числе и узнать, какой шейп его вызвал.<br />4. Как создать Add-On объяснять довольно долго. Да и не приходилось мне создавать их на Delphi. Лучше всего скачать SDK Visio. Там, во-первых, написано, как это делается (правда, не по-русски), во-вторых, есть примеры (основа Add-On) для VB и C. Они хорошо комментированы, так что, даже не зная языка, можно понять суть того, что делается, и попытаться воспроизвести это на Delphi.<br />Ну, а если писать на VB, то можно просто брать эту основу и начинать пристраивать к ней свои функции...</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=907.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">davinchi</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>6 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="3069"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;12/07/2006&nbsp;:&nbsp; 01:38:07</font>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> 1. Большое спасибо за разъяснение терминологии, я третий день юзаю Visio и для меня это многое прояснило... Вы правильно поняли, создаю именно мастер-шейп. <b>Тогда попутно возникает вопрос что такое шаблон и биюлиотека шаблонов?</b><br />2. Под связью с трафоретом понимается Add-in или Add-on. На сколько я понял из прочитанного на этом форуме Add-in это DLL пригружаемая в Visio, а Add-on это exe или dll используемая во вне от Visio, но Visio может ругаться при вызове Add-on предупреждая о безопасности. Чтобы этого избежать актуальнее использовать Add-in.<br />3. Для меня очень проблемотично разобрать код VB и C# т.к. не знаком с модулями, функциями и процидурами, используемыми в примерах SDK. Задам вопрос прямо - что из себя представляет Add-in, т.е. меня интересуют следующие вопросы:<br /><ul><br /><li>Add-in это DLL???</li><br /><li>Add-in это DLL содержащая COM объект или ActiveX?</li><br /><li>Какие интерфейсы необходимо реализовать в Add-in?</li><br /><li>Как зарегистрировать Add-in? (обычно regsvr32 &lt;FileName.dll&gt;)</li><br /><li>Как из шейпа обратиться к Add-in? (т.е. не просто же в EventDblClick писать выполнение аддона с параметрами, надо же указать где Add-in находится и его GUID где-то должен быть прописан?)</li><br /><li>Как в Add-in получить переданные параметры? (в дельфя у exe'шников параметры получаются через функцию ParamStr(&lt;NumbrParametr&gt;), в Add-in также только через Command(&lt;NumbrParametr&gt;) ? )</li></ul><br /><i>И еще одна маленькая просьба, если у Вас сеть возможность связаться со моной по ISQ, то очень Вас прошу связаться, так общение будет быстрее, я к тому что мне эта инфа горит срочно, т.е. горят сроки на выполнение работы... подробнее в личной переписке... Мой ISQ: 276-801-195</i></span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=907.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Tumanov</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>1198 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="3070"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;12/07/2006&nbsp;:&nbsp; 18:38:16</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Понятие шаблон (Template) аналогично Word. Это заготовка документа, рисунка; окружение, служащее основой для создания схожих документов.<br />То, что я писал выше, относилось к Add-On. Отличия между Add-In и Add-On Вы поняли правильно. Вот только "актуальнее использовать Add-in" - не совсем точно. В разных случаях по-разному. Кроме того, Add-On перестает ругаться, если он подписан или если снижен уровень безопасности, а Add-In не ругается только потому, что его регистрируют при установке.<br />Важно другое - Add-On вызывается в любое время хоть пользователем через интерфейс, хоть через RunAddon из ShapeSheet произвольного шейпа. Add-In же нельзя вызвать. Он сидит в памяти и реагирует только на события, поэтому из ShapeSheet его просто так не запустишь. (Хотя существует обходная технология с созданием события MarkerEvent через QUEUEMARKEREVENT).<br />По остальным вопросам в SDK есть отдельная статья "About Microsoft Office Visio Add-ons and COM Add-ins". В частности в ней сказано - "In Visio, the term add-in refers specifically to a COM add-in, a COM object that implements the IDTExtensibility2 interface".<br />К сожалению, интернет для меня доступен только по вечерам из дома через модем, так что о ISQ можно только мечтать :(<br /></span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=907.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">davinchi</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>6 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="3071"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;12/08/2006&nbsp;:&nbsp; 00:30:35</font>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> А чем технологисески отличается Add-on от Add-in, т.е. различия во внутреннем устройстве, если я правильно понял Add-on содержит СОМ объект, а Add-in содержит ActiveX обект, я прав?<br />Англиский знаю плохо, поэтому разобраться в SDK - нужно время, которого нет, пожалуйса, если не трудно, объясните коротко саму суть создания аддона, например:<br />1. создать DLL<br />2. реализовать в ней COM или ActiveX объект<br />3. реализовать интерфеис ... (если необходимо)<br />4. "вот так" обрабатывать события от шейпа<br />5. "положить файл туда"<br />6. "вот так" связать шеп с аддоном...<br />... или ссылочки на эту информацю...</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=907.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">davinchi</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>6 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="3076"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;12/10/2006&nbsp;:&nbsp; 23:31:16</font>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Люди HELP!!!<br />... ну хоть какую-нить информацию или ссылочки на пример, приз <img src="icon_smile_sad.gif" width="15" height="15" border="0" alt="" title="" align="middle" /><br />Подскажите как из шейпа обратиться к аддону в DLL???</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=907.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">davinchi</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>6 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="3077"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;12/10/2006&nbsp;:&nbsp; 23:37:14</font>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> ...подскажите где должен лежать аддон в виде exe файла?</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=907.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">immortal</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>391 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="3095"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;12/18/2006&nbsp;:&nbsp; 12:52:54</font>
                      &nbsp;<a href="http://www.immortal.vstu.edu.ru" target="_blank"><img src="icon_homepage.gif" width="15" height="15" border="0" alt="Visit immortal's Homepage" title="Visit immortal's Homepage" align="absmiddle" hspace="6" /></a>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> <font size="1" face="Verdana, Arial, Helvetica" id="quote"><blockquote id="quote">quote:<hr height="1" noshade id="quote"> ...подскажите где должен лежать аддон в виде exe файла?<hr height="1" noshade id="quote"></blockquote></font><br /><a href="http://www.immortal.vstu.edu.ru/index.php?name=Pages&op=page&pid=16" target="_blank">http://www.immortal.vstu.edu.ru/index.php?name=Pages&op=page&pid=16</a><br /><br /> <font size="1" face="Verdana, Arial, Helvetica" id="quote"><blockquote id="quote">quote:<hr height="1" noshade id="quote">Add-in ...<hr height="1" noshade id="quote"></blockquote></font><br /><br />я только делал адд-ин с запуском через кнопки панели и меню, как запускать из шейплиста уже вопрос задавался мной на форуме, ответ отрицательный.<br /><br />визио 2003 форэвер<br /><br />...а вобще-то я белый и пушистый.</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=907.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Tumanov</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>1198 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="3096"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;12/18/2006&nbsp;:&nbsp; 13:26:09</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Как это отрицательный??<br />Я же написал: "(Хотя существует обходная технология с созданием события MarkerEvent через QUEUEMARKEREVENT)".<br />А вот упрощенная проверка такого метода. Только она приводится для макроса, но и в Add-In должна работать:<br />Запуск Add-In из ShapeSheet<br />Add-In напрямую из ShapeSheet вызвать нельзя (вызываются только Add-On и макросы). Но Add-In может реагировать на события. Значит если из ShapeSheet сгенерировать событие, то Add-In его поймает и обработает.<br />Для простоты проверяем сначала на макросах.<br />Специальное событие для данного случая - MarkerEvent. Его обрабатывает объект Application.<br />Создаем такой объект и пишем обработчик.<br /><br />Dim WithEvents Ap As Visio.Application<br />Sub ttt()<br />    Set Ap = ActivePage.Application<br />End Sub<br /><br />Private Sub Ap_MarkerEvent(ByVal app As IVApplication, ByVal SequenceNum As Long, ByVal ContextString As String)<br />    Debug.Print ContextString<br />End Sub<br /><br />На листе Visio рисуем прямоугольник и в ячейку EventXFMod прописываем строку<br />=if(Pinx&gt;2;QUEUEMARKEREVENT("Больше");QUEUEMARKEREVENT("Меньше"))<br /><br />Теперь перемещение прямоугольника должно привести к формированию той или иной текстовой строки.<br />В принципе, перемещение можно было отловить и по другому событию, но в данном случае задача - не найти оптимальное решение, а проверить технический прием.<br />Проверяем. Если теперь подвигать шейп, ничего не происходит (Объект Ap на обрабатывает событий). Выполняем макрос ttt, который заставляет Ap обрабатывать события, и наблюдаем при каждом перемещении шейпа появление строчки в окне Immediate.<br />Естественно, обработчик события с таким же успехом вместо макроса можно поместить в Add-In.</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=907.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">davinchi</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>6 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="3097"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;12/18/2006&nbsp;:&nbsp; 17:31:46</font>
                      
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> я пишу на Delphi и используюю DLL...<br />обрабатывать события от меню и конопок вроде понятно как, а как получтить собфтие при обращении к Add-in с помощью RUNADDINWARGS пока безответный вопрос? Если кто-нить просветит буду очень благодарен...<br />P.S. Есть предположение что у шейапа надо запрашивать какой-то интерфейс событий, а к нему прикручивать процедуру реагирующую на событие, вопрос в имени интерфейса...</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=907.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText">Tumanov</span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>1198 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="3101"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;12/18/2006&nbsp;:&nbsp; 20:25:51</font>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> RUNADDINWARGS - не бывает и не будет.<br />Если Вы работаете с Add-In то можно только реагировать на события. Вместо RUNADDINWARGS нужно сгенерировать событие, которое примет Add-In.<br />Пример генерации события приведен на несколько строчек выше.<br />Вы можете и просто написать QUEUEMARKEREVENT() с нужными параметрами без всяких If.<br />Как установить связь по событиям с Add-In - хорошо расписано в SDK Visio 2003 раздел Event Handling тема AddAdvise.<br />Единственное, что Вам не подходит, так это то, что код приведен на VBA. Но его только нужно перевести на Delphi. Принципы одинаковые для любого языка.<br />По смыслу: нужно в dll Add-In создать объект, принимающий уведомления о событиях (обработчик); при старте dll или в обработке события открытия нужного документа передать указатель на этот объект в Visio, создав объект Event с типом MarkerEvent (это visEvtApp+visEvtMarker = &H1100), и ждать.<br />В нужный момент в шейп-листе сработает QUEUEMARKEREVENT.  При этом сгенеритуется событие MarkerEvent. Оно будет отловлено настроенным на него Вашим объектом Event, который тут же уведомит находящийся в dll объект Sink. А там уже заготовлен обработчик :)<br />(Вообще, надо будет как-нибудь статью с картинками написать... Чувствую, тема непростая...)</span></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=907.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td align="center" bgcolor="midnightblue" width="100" nowrap><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">&nbsp;</font></b></td>
                <td align="center" bgcolor="midnightblue" width="100%"><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">
                <a href="topic.asp@TOPIC_ID=905.html"><img src="icon_go_left.gif" width="15" height="15" border="0" alt="Previous Topic" title="Previous Topic" align="top" hspace="6" /></a><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">&nbsp;Topic&nbsp;</font></b><a href="topic.asp@TOPIC_ID=922.html"><img src="icon_go_right.gif" width="15" height="15" border="0" alt="Next Topic" title="Next Topic" align="top" hspace="6" /></a></font></b></td>
                <td align="right" bgcolor="midnightblue" nowrap><font face="Verdana, Arial, Helvetica" size="2">&nbsp;</font></td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table align="center" border="0" cellPadding="0" cellSpacing="0" width="95%">
  <tr>
    <td>
      <table width="100%">
        <tr>
          <td align="center" bgcolor="#ffffAA"><font face="Verdana, Arial, Helvetica" size="2">Данный сайт является архивом форума visio.artberg.ru, который был закрыт в связи с переходом на новую платформу <b><a href="http://visio.getbb.ru">visio.getbb.ru</a></b><br/>Все материалы доступны только для чтения! Если у вас появились вопросы, или вы хотите что-то обсудить, связанное с Visio, обращайтесь на новый форум!<br/>Архив был создан благодаря совместным усилиям Генадия Туманова @Tumanov (<a href="http://visio.artberg.ru">visio.artberg.ru</a>), Александра ака @Surrogate (<a href="http://visio.getbb.ru">visio.getbb.ru</a>), и Николая Белых @nbelyh (<a href="http://unmanagedvisio.com">unmanagedvisio.com</a>)</font></td>
        </tr>
      </table>
  </td>
 </tr>
</table>
</body>
</html>
