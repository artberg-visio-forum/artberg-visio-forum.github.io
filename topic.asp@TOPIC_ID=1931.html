<html>

<head>
<title>Visio - Как отобразить номер другой страницы?</title>
<meta name="copyright" content="This Forum code is Copyright (C) 2000-09 Michael Anderson, Pierre Gorissen, Huw Reddick and Richard Kinser, Non-Forum Related code is Copyright (C) 2000-02 Snitz Communications">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" /><script language="JavaScript" type="text/javascript">
<!-- hide from JavaScript-challenged browsers
function openWindow(url) {
	popupWin = window.open(url,'new_page','width=400,height=400')
}
function openWindow2(url) {
	popupWin = window.open(url,'new_page','width=400,height=450')
}
function openWindow3(url) {
	popupWin = window.open(url,'new_page','width=400,height=450,scrollbars=yes')
}
function openWindow4(url) {
	popupWin = window.open(url,'new_page','width=400,height=525')
}
function openWindow5(url) {
	popupWin = window.open(url,'new_page','width=450,height=525,scrollbars=yes,toolbars=yes,menubar=yes,resizable=yes')
}
function openWindow6(url) {
	popupWin = window.open(url,'new_page','width=500,height=450,scrollbars=yes')
}
function openWindowHelp(url) {
	popupWin = window.open(url,'new_page','width=470,height=200,scrollbars=yes')
}
// done hiding -->
</script>
<style type="text/css">
<!--
a:link    {color:darkblue;text-decoration:underline}
a:visited {color:blue;text-decoration:underline}
a:hover   {color:red;text-decoration:underline}
a:active  {color:red;text-decoration:}
.spnMessageText a:link    {color:darkblue;text-decoration:underline}
.spnMessageText a:visited {color:blue;text-decoration:underline}
.spnMessageText a:hover   {color:red;text-decoration:underline}
.spnMessageText a:active  {color:red;text-decoration:underline}
.spnSearchHighlight {background-color:yellow}
input.radio {background:lightsteelblue;color:#000000}
-->
</style>
</head>

<body bgColor="white" text="midnightblue" link="darkblue" aLink="red" vLink="blue">
<a name="top"></a>

<table align="center" border="0" cellPadding="0" cellSpacing="0" width="100%">
  <tr>
    <td align="center" valign="top" width="50%">
      <table border="0" cellPadding="2" cellSpacing="0">
        <tr>
          <td align="center"><font face="Verdana, Arial, Helvetica" size="2"><b>Visio</b></font></td>
        </tr>
        <tr>
          <td align="center"><font face="Verdana, Arial, Helvetica" size="1">
</font></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table align="center" border="0" cellPadding="0" cellSpacing="0" width="95%">
  <tr>
    <td>
    <script language="JavaScript" type="text/javascript">
    <!--
    function unsub_confirm(link){
    	var where_to= confirm("Do you really want to Unsubscribe?");
       if (where_to== true) {
       	popupWin = window.open(link,'new_page','width=400,height=400')
       }
    }
    //-->
    </script>
    <script language="JavaScript" type="text/javascript">
    function ChangePage(fnum){
    	if (fnum == 1) {
    		document.PageNum1.submit();
    	}
    	else {
    		document.PageNum2.submit();
    	}
    }
    </script>
    <script language="JavaScript" type="text/javascript">
    <!--
    function jumpTo(s) {if (s.selectedIndex != 0) location.href = s.options[s.selectedIndex].value;return 1;}
    // -->
    </script>
      <table border="0" width="100%">
        <tr>
          <td width="50%" align="left" nowrap><font face="Verdana, Arial, Helvetica" size="2">
          <img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="default.asp.html">All Forums</a><br />
          <img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="default.asp@CAT_ID=2.html">Категория Visio</a><br />
          <img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;<a href="forum.asp@FORUM_ID=2.html">Форум Вопросы и ответы</a><br />
          <img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_blank.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_bar.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" /><img src="icon_folder_open_topic.gif" width="15" height="15" border="0" alt="" title="" align="absmiddle" />&nbsp;Как отобразить номер другой страницы?</font></td>
          <td align="center" width="50%">
          <font face="Verdana, Arial, Helvetica" size="2">
          </font></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table align="center" border="0" cellPadding="0" cellSpacing="0" width="95%">
  <tr>
    <td>
      <table border="0" width="100%" cellspacing="0" cellpadding="0" align="center">
        <tr>
          <td bgcolor="black">
            <table border="0" width="100%" cellspacing="1" cellpadding="4">
              <tr>
                <td align="center" bgcolor="midnightblue" width="100" nowrap><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">Author</font></b></td>
                <td align="center" bgcolor="midnightblue" width="100%"><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">
                <a href="topic.asp@TOPIC_ID=1935.html"><img src="icon_go_left.gif" width="15" height="15" border="0" alt="Previous Topic" title="Previous Topic" align="top" hspace="6" /></a><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">&nbsp;Topic&nbsp;</font></b><a href="topic.asp@TOPIC_ID=1919.html"><img src="icon_go_right.gif" width="15" height="15" border="0" alt="Next Topic" title="Next Topic" align="top" hspace="6" /></a></font></b></td>
                <td align="right" bgcolor="midnightblue" nowrap><font face="Verdana, Arial, Helvetica" size="2">&nbsp;</font></td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font color="midnightblue" face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText"><a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=2995" title="View Oleg_B's Profile" onMouseOver="(window.status='View Oleg_B\'s Profile'); return true" onMouseOut="(window.status=''); return true">Oleg_B</a></span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>3 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" width="100%" colspan="2" valign="top">
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;04/26/2008&nbsp;:&nbsp; 11:52:12</font>
                      &nbsp;<a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=2995"><img src="icon_profile.gif" width="15" height="15" border="0" alt="Show Profile" title="Show Profile" align="absmiddle" hspace="6" /></a>
                      &nbsp;<a href="http://nikolay-256e33c/post.asp?method=TopicQuote&amp;TOPIC_ID=1931&amp;FORUM_ID=2"><img src="icon_reply_topic.gif" width="15" height="15" border="0" alt="Reply with Quote" title="Reply with Quote" align="absmiddle" hspace="6" /></a>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Здравствуйте всем! :)<br /><br />Может быть, кто-нибудь знает, как сделать следующую вещь:<br />Мне нужно в многостраничном документе на одной странице вывести (внутри какого-нибудь шейпа) надпись  "См. на стр. &lt;номер_страницы&gt;", в которой номер_страницы ссылается на другую страницу, т. е. на первой странице мне надо, чтобы выводилась, например, надпись "См. на стр. 2". В принципе, достаточно выводить только номер страницы. Но необходимо, чтобы при изменении порядка следования страниц в документе, эти изменения автоматически отражались и в моей надписи, т. е. если страница, которая была второй, стала четвертой, то и надпись у меня стала "См. на стр. 4". <br />Нечто подобное происходит, когда в шейп всталяешь поле с номером страницы, но там привязка существует только к текущей странице, а вот чтобы к другой странице - такого я не смог найти.<br /><br />Может быть, кто знает, возможно ли сделать такую вещь без использования VBA? Или здесь только VBA поможет?<br /><br />Заранее спасибо! :))</span id="msg"></font></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText"><a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=1" title="View Tumanov's Profile" onMouseOver="(window.status='View Tumanov\'s Profile'); return true" onMouseOut="(window.status=''); return true">Tumanov</a></span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>1198 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="3625"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;04/26/2008&nbsp;:&nbsp; 14:34:07</font>
                      &nbsp;<a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=1"><img src="icon_profile.gif" width="15" height="15" border="0" alt="Show Profile" title="Show Profile" align="absmiddle" hspace="6" /></a>
                      &nbsp;<a href="http://nikolay-256e33c/post.asp?method=ReplyQuote&amp;REPLY_ID=3625&amp;TOPIC_ID=1931&amp;FORUM_ID=2"><img src="icon_reply_topic.gif" width="15" height="15" border="0" alt="Reply with Quote" title="Reply with Quote" align="absmiddle" hspace="6" /></a>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Пока не знаю, как сделать (времени нет подумать), но решение возможно.<br />Номер страницы получается функцией PageNumber().<br />Для вставки его в шейп в виде текста нужно с этим шейпом проделать Insert / Field / Page Info / Page Number.<br />Сходу не получилось сослаться на номер чужой страницы. Но криво можно сделать уже сейчас, используя то, что можно сослаться на шейп на чужой странице.<br />Разместить на чужой странице первый шейп (невидимый). В какую-нибудь его ячейку (да хоть в Width) вставить PageNumber(). А из шейпа на первой странице выбираться этот номер примерно так =Pages[Page-2]!Sheet.1!Width.<br />При перестановках страниц ссылка работет нормально.<br />Естественно, лучше использовать не Width, а какую-нибудь другую ячейку (она у меня просто первой под руку подвернулась :).</span id="msg"></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=1931.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText"><a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=2995" title="View Oleg_B's Profile" onMouseOver="(window.status='View Oleg_B\'s Profile'); return true" onMouseOut="(window.status=''); return true">Oleg_B</a></span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>3 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="3626"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;04/26/2008&nbsp;:&nbsp; 15:35:55</font>
                      &nbsp;<a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=2995"><img src="icon_profile.gif" width="15" height="15" border="0" alt="Show Profile" title="Show Profile" align="absmiddle" hspace="6" /></a>
                      &nbsp;<a href="http://nikolay-256e33c/post.asp?method=ReplyQuote&amp;REPLY_ID=3626&amp;TOPIC_ID=1931&amp;FORUM_ID=2"><img src="icon_reply_topic.gif" width="15" height="15" border="0" alt="Reply with Quote" title="Reply with Quote" align="absmiddle" hspace="6" /></a>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Спасибо большое, Геннадий! :)<br /><br />Решение действительно прекрасно, особенно если учесть, что у меня на каждой странице есть шейп с номером этой страницы, так что необходимость в невидимом шейпе отпадает. Но есть одна неприятная особенность Visio 2003: он не любит русских названий страниц. :)) Если у меня страница называется Page-4, то формула вписывается без проблем, а вот если она называется Страница-4, то выдается сообщение об ошибке в формуле. Ну а пробелы в названиях страниц Visio не воспринимает не по-русски, не по-английски. :))<br /><br />Но, думаю, не стоит больше заморачиваться над моим вопросом. Я буду обходить эти ограничения на язык и пробелы через VBA (без него, похоже, не обойтись, если я хочу делать минимум кликов :)) ). Кстати, если вставлять формулу через VBA, то эти проблемы не возникают. :)) К тому же, есть такой мастер "Off-page reference", который при бросании его на страницу сразу запрашивает на какую страницу ему ссылаться. Если мне удасться в моем мастере совместить поведение мастера "Off-page reference" и то решение, которые Вы предложили, но с вводом формулы через VBA, то моя проблема будет решена.<br /><br />Еще раз большое спасибо! :)<br />Вопрос снят.</span id="msg"></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom"><hr noshade size="1" color="whitesmoke"><font face="Verdana, Arial, Helvetica" size="1" color="midnightblue">Edited by - Oleg_B on 04/26/2008  15:38:03</font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=1931.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText"><a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=597" title="View zhuravsky's Profile" onMouseOver="(window.status='View zhuravsky\'s Profile'); return true" onMouseOut="(window.status=''); return true">zhuravsky</a></span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>115 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="3632"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;04/28/2008&nbsp;:&nbsp; 18:48:57</font>
                      &nbsp;<a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=597"><img src="icon_profile.gif" width="15" height="15" border="0" alt="Show Profile" title="Show Profile" align="absmiddle" hspace="6" /></a>
                      &nbsp;<a href="http://nikolay-256e33c/post.asp?method=ReplyQuote&amp;REPLY_ID=3632&amp;TOPIC_ID=1931&amp;FORUM_ID=2"><img src="icon_reply_topic.gif" width="15" height="15" border="0" alt="Reply with Quote" title="Reply with Quote" align="absmiddle" hspace="6" /></a>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> У меня была похожая (даже более сложная задача) и я пошел примерно тем путем, который подсказывает Геннадий. Тогда я плохо знал Визио, поэтому сейчас я бы сделал так:<br />Завел бы в ShapeSheet  страницы в секции User или Prop свою ячейку и прописал бы туда номер (а может завтра вам понадобится и не только номер).<br />После этого можно на него сослаться, кажется как-то так<br />Pages[Page-20]!ThePage!Prop.number</span id="msg"></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=1931.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText"><a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=597" title="View zhuravsky's Profile" onMouseOver="(window.status='View zhuravsky\'s Profile'); return true" onMouseOut="(window.status=''); return true">zhuravsky</a></span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>115 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="3633"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;04/28/2008&nbsp;:&nbsp; 18:50:39</font>
                      &nbsp;<a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=597"><img src="icon_profile.gif" width="15" height="15" border="0" alt="Show Profile" title="Show Profile" align="absmiddle" hspace="6" /></a>
                      &nbsp;<a href="http://nikolay-256e33c/post.asp?method=ReplyQuote&amp;REPLY_ID=3633&amp;TOPIC_ID=1931&amp;FORUM_ID=2"><img src="icon_reply_topic.gif" width="15" height="15" border="0" alt="Reply with Quote" title="Reply with Quote" align="absmiddle" hspace="6" /></a>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Естественно, номер нужно прописывать не константой, а функцией PageNumber</span id="msg"></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=1931.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText"><a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=597" title="View zhuravsky's Profile" onMouseOver="(window.status='View zhuravsky\'s Profile'); return true" onMouseOut="(window.status=''); return true">zhuravsky</a></span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>115 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="3634"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;04/28/2008&nbsp;:&nbsp; 18:53:18</font>
                      &nbsp;<a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=597"><img src="icon_profile.gif" width="15" height="15" border="0" alt="Show Profile" title="Show Profile" align="absmiddle" hspace="6" /></a>
                      &nbsp;<a href="http://nikolay-256e33c/post.asp?method=ReplyQuote&amp;REPLY_ID=3634&amp;TOPIC_ID=1931&amp;FORUM_ID=2"><img src="icon_reply_topic.gif" width="15" height="15" border="0" alt="Reply with Quote" title="Reply with Quote" align="absmiddle" hspace="6" /></a>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Кстати, а не пробовали использовать Insert\Hyperlink (Ctrl-K) ?</span id="msg"></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=1931.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="whitesmoke" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText"><a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=2995" title="View Oleg_B's Profile" onMouseOver="(window.status='View Oleg_B\'s Profile'); return true" onMouseOut="(window.status=''); return true">Oleg_B</a></span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>3 Posts</small></font></p></td>
                <td bgcolor="whitesmoke" height="100%" width="100%" colspan="2" valign="top"><a name="3635"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;04/29/2008&nbsp;:&nbsp; 08:10:49</font>
                      &nbsp;<a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=2995"><img src="icon_profile.gif" width="15" height="15" border="0" alt="Show Profile" title="Show Profile" align="absmiddle" hspace="6" /></a>
                      &nbsp;<a href="http://nikolay-256e33c/post.asp?method=ReplyQuote&amp;REPLY_ID=3635&amp;TOPIC_ID=1931&amp;FORUM_ID=2"><img src="icon_reply_topic.gif" width="15" height="15" border="0" alt="Reply with Quote" title="Reply with Quote" align="absmiddle" hspace="6" /></a>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> <blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by zhuravsky</i><br /><br />...<br />Завел бы в ShapeSheet  страницы в секции User или Prop свою ячейку и прописал бы туда номер (а может завтра вам понадобится и не только номер).<br />После этого можно на него сослаться, кажется как-то так<br />Pages[Page-20]!ThePage!Prop.number<br /><hr height="1" noshade id="quote"></font id="quote"></blockquote id="quote">Тоже вариант. Спасибо! Особенно, если нужен не только номер. <img src="icon_smile.gif" width="15" height="15" border="0" alt="" title="" align="middle" /> Но у него есть один недостаток: для вновь добавляемых страниц необходимо открывать их ШейпЩит и добавлять туда нужную секцию и прописывать формулу в строку (во всяком случае, я не нашел возможности наследовать юзер_секции во вновь создаваемые страницы; может плохо искал<img src="icon_smile.gif" width="15" height="15" border="0" alt="" title="" align="middle" />). Положить же готовый шейп (с полем номера страницы) на страницу гораздо быстрее. <img src="icon_smile.gif" width="15" height="15" border="0" alt="" title="" align="middle" /><br /><br /><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by zhuravsky</i><br /><br />...<br /> Кстати, а не пробовали использовать Insert\Hyperlink (Ctrl-K) ?<br /><hr height="1" noshade id="quote"></font id="quote"></blockquote id="quote">Гиперлинк пробовал, и даже использовал, но немного по-другому, поскольку в обычном варианте, о котором Вы говорите, линк на страницу разрывается, если целевая страница переименовывается. К тому же в этом случае при распечатке документа я не увижу номера нужной страницы.<br /><br />Я на самом деле уже сделал все, что хотел, и все работает, как мне надо. :)) Поясню, что мне было надо:<br />Я занимаюсь сейчас тем, что разбиваю огроменную блок схему на отдельные кусочки, которые умещались бы на странице А4. Получается некая иерархия взаимосвязанных страниц. Для ускорения этого дела мне было нужно средство, которое позволило бы мне после распечатки документа, глядя на страницу с каким-нибудь узлом, знать, на какой странице (страницах) находится его детализация. Таким образом, мне была прежде всего необходима (1) нумерация страниц и (2) какой-нибудь шейп, в котом было бы написано "см. на стр. &lt;номер_страницы&gt;". Вручную прописывать все эти вещи можно, но опасно (не говоря о том, что просто муторно), потому что страниц в документе будет несколько десятков, если не зайдет за сотню, и они к тому же могут переименовываться и перемещаться, т.е. менять свой номер. Вручную отслеживать все эти изменения и править соответствующие шейпы - дело трудное, и вряд ли я избежал бы ошибок. Поэтому надо было все это автоматизировать. Так, я создал два МастерШейпа: шейп с номером страницы и более сложный шейп, который при бросании его на страницу делает следущие вещи:<br /><br />1. Запрашивает, на какую страницу ему ссылаться.<br />2. Если нужна новая страница, то он создает ее и помещает на нее шейп с ее номером.<br />3. В своем текстовом поле формирует вышеупомянутую надпись и отслеживает актуальный номер целевой страницы, какие бы манипуляции с ней не происходили (кроме удаления, разумеется).<br />4. При двойном клике на нем открывает мне целевую страницу.<br />5. Бросает еще одну копию себя на целевую страницу.<br />6. Делает в своей копии на целевой странице ссылку на страницу текущую и формирует такую же надпись, но с номером текущей страницы.<br />7. И наконец указывает, что при двойном клике на шейпе-копии открывать текущую страницу.<br /><br />Короче, образуется перекрестная ссылка между страницами, которая дает возможность, с одной стороны, быстро перемещаться между ними в электронном документе, а с другой стороны, дает возможность "перемещаться" между страницами и после их распечатки. И все это не зависит от фактического названия страниц и их порядка. Очень удобно. <img src="icon_smile_big.gif" width="15" height="15" border="0" alt="" title="" align="middle" /><br /><br />Все это, конечно, делает не сам МастерШейп, а код VBA, который запускается по событию бросания_на_лист. Функциональность готового шейпа, о котором я писал в предыдущем посте, задействовать не удалось, поэтому пришлось быстро наваять форму для выбора\создания страницы. Сам шейп я все же использовал - очень он мне нравится <img src="icon_smile_big.gif" width="15" height="15" border="0" alt="" title="" align="middle" />, - но отключил его от его аддона. И еще я сделал одну большую функцию в документе, которая и выполняет все те шаги. Проблемы с русскими названиями и пробелами в VBA, похоже, отсутствуют и формулы вставляются без проблем. А проблема с гиперлинком, о которой я говорил выше, решается тоже просто: я использовал не секцию Гиперлинк, а в событие "ДвойнойКлик" прописал формулу HYPERLINK("", "имя_целевой_страницы", "", FALSE, "") - в этом случае переименование страницы не влияет на работу этой функции и я перемещаюсь на нужную страницу всегда. Пункты 3 и 6 сценария реализуются тем способом, который подсказал Геннадий, но из VBA.<br /> <br />Поскольку я, вообще, не работаю с Визио, и мне было все это нужно лишь для одного этого документа, то код писал очень быстро и не универсально, а потому, возможно, путано, поэтому не привожу его здесь, но если кому надо и кто готов разобраться в нем <img src="icon_smile_big.gif" width="15" height="15" border="0" alt="" title="" align="middle" />, то я выложу.</span id="msg"></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=1931.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td bgcolor="gainsboro" valign="top" width="100" nowrap>
                <p><font face="Verdana, Arial, Helvetica" size="2"><b><span class="spnMessageText"><a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=597" title="View zhuravsky's Profile" onMouseOver="(window.status='View zhuravsky\'s Profile'); return true" onMouseOut="(window.status=''); return true">zhuravsky</a></span></b></font><br />
                </p>
                <p>
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>Russia</small></font><br />
                <font color="midnightblue" face="Verdana, Arial, Helvetica" size="1"><small>115 Posts</small></font></p></td>
                <td bgcolor="gainsboro" height="100%" width="100%" colspan="2" valign="top"><a name="3637"></a>
                  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td valign="top">
                      <img src="icon_posticon.gif" width="15" height="15" border="0" alt="" title="" hspace="3" /><font color="midnightblue" face="Verdana, Arial, Helvetica" size="1">Posted&nbsp;-&nbsp;04/29/2008&nbsp;:&nbsp; 17:15:56</font>
                      &nbsp;<a href="http://nikolay-256e33c/pop_profile.asp?mode=display&amp;id=597"><img src="icon_profile.gif" width="15" height="15" border="0" alt="Show Profile" title="Show Profile" align="absmiddle" hspace="6" /></a>
                      &nbsp;<a href="http://nikolay-256e33c/post.asp?method=ReplyQuote&amp;REPLY_ID=3637&amp;TOPIC_ID=1931&amp;FORUM_ID=2"><img src="icon_reply_topic.gif" width="15" height="15" border="0" alt="Reply with Quote" title="Reply with Quote" align="absmiddle" hspace="6" /></a>
                      <hr noshade size="1"></td>
                    </tr>
                    <tr>
                      <td valign="top" height="100%"><font face="Verdana, Arial, Helvetica" size="2" color="midnightblue"><span class="spnMessageText" id="msg"> Я решил похожую задачу: мне нужно рисовать компоновочные и электрические схемы контроллерных шкафов. Файлы тоже получаются по 50-100 страниц, плюс своя специфика (DIN, KKS и т.п.). На данный момент решение примерно как у вас.<br />Я только добавил на VBA обработчик события создания страницы, по которому необходимые шейпы вставляются автоматически. Собственно, поэтому и предлагал заводить все, что нужно прямо в самой странице (если есть обработчик события, то все-равно создавать нужные проперти или вставлять мастер-шейп).<br />Все это упаковано в шаблон VST.<br />Правда, проблему с разными языками не решил (за ненадобностью).</span id="msg"></font></td>
                    </tr>
                    <tr>
                      <td valign="bottom" align="right" height="20"><a href="topic.asp@TOPIC_ID=1931.html#top"><img src="icon_go_up.gif" width="15" height="15" border="0" alt="Go to Top of Page" title="Go to Top of Page" align="right" /></a></td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td align="center" bgcolor="midnightblue" width="100" nowrap><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">&nbsp;</font></b></td>
                <td align="center" bgcolor="midnightblue" width="100%"><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">
                <a href="topic.asp@TOPIC_ID=1935.html"><img src="icon_go_left.gif" width="15" height="15" border="0" alt="Previous Topic" title="Previous Topic" align="top" hspace="6" /></a><b><font face="Verdana, Arial, Helvetica" size="2" color="mintcream">&nbsp;Topic&nbsp;</font></b><a href="topic.asp@TOPIC_ID=1919.html"><img src="icon_go_right.gif" width="15" height="15" border="0" alt="Next Topic" title="Next Topic" align="top" hspace="6" /></a></font></b></td>
                <td align="right" bgcolor="midnightblue" nowrap><font face="Verdana, Arial, Helvetica" size="2">&nbsp;</font></td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table align="center" border="0" cellPadding="0" cellSpacing="0" width="95%">
  <tr>
    <td>
      <table width="100%">
        <tr>
          <td align="center" valign="top" width="50%">
          <font face="Verdana, Arial, Helvetica" size="2">
          </font></td>
          <td align="right" valign="top" width="50%" nowrap>
          </td>
        </tr>
      </table>
